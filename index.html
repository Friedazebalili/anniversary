<body>

<div class="bg-icon" style="top: 8%; left: 8%; font-size: 3rem;">ğŸ°</div>
<div class="bg-icon" style="bottom: 12%; right: 8%; font-size: 2.5rem;">ğŸ’–</div>
<div class="bg-icon" style="top: 20%; right: 18%; font-size: 3rem;">âœ¨</div>
<div class="bg-icon" style="bottom: 15%; left: 15%; font-size: 2rem;">ğŸŒ¸</div>

<div class="container">

    <!-- STAGE 1: MEMORY GAME -->
    <div id="memory-stage">
        <h1>Bunny Memory Test ğŸ§ ğŸ°</h1>
        <p>Match all the bunny pairs to continue ğŸ’•</p>

        <div id="memory-grid"></div>
    </div>

    <!-- STAGE 2: MAZE -->
    <div id="maze-stage" style="display:none;">
        <h1>Help Bunny Get the Carrot ğŸ¥•ğŸ‡</h1>
        <p>Use arrow keys or buttons!</p>

        <div id="maze">
            <div id="bunny">ğŸ°</div>
            <div id="goal">ğŸ¥•</div>
        </div>

        <div class="controls">
            <button onclick="move('up')">â¬†ï¸</button><br>
            <button onclick="move('left')">â¬…ï¸</button>
            <button onclick="move('down')">â¬‡ï¸</button>
            <button onclick="move('right')">â¡ï¸</button>
        </div>
    </div>

    <!-- STAGE 3: PROPOSAL (UNCHANGED) -->
    <div id="proposal-stage" style="display:none;">
        <img src="https://media.giphy.com/media/kZqbBT64XCxoc/giphy.gif" class="bunny-img">
        <h1>My Dearest Bunny...</h1>
        <p>You make my heart hop! ğŸ‡ğŸ’“</p>
        <h2 style="color:#d63384;font-family:'Pacifico';">
            Will you be my Valentine?
        </h2>

        <div class="btn-group">
            <button class="btn-yes" onclick="sayYes()">YES! ğŸ˜</button>
            <button class="btn-no" id="noBtn"
                onmouseover="moveButton()"
                ontouchstart="moveButton()">NO ğŸ˜¢</button>
        </div>
    </div>

    <!-- SUCCESS STAGE (UNCHANGED) -->
    <div id="success-stage" style="display:none;">
        <h1>YAY!!! ğŸ‰ğŸ’ƒğŸ»</h1>
        <div class="big-kiss">ğŸ’‹ğŸ’</div>
        <p>You are officially my Valentine!</p>
        <p>I love you so much! ğŸ’–ğŸ‡</p>
        <img src="https://media.giphy.com/media/T86i6yDyOYz7J6dPhf/giphy.gif"
             style="width:200px;border-radius:10px;">
    </div>

</div>

<script>
/* ================= MEMORY GAME ================= */
const symbols = ['ğŸ°','ğŸ°','ğŸ’–','ğŸ’–','ğŸ¥•','ğŸ¥•'];
let flipped = [];
let matched = 0;

const grid = document.getElementById('memory-grid');
symbols.sort(() => 0.5 - Math.random());

symbols.forEach(sym => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerText = 'â”';
    card.onclick = () => flip(card, sym);
    grid.appendChild(card);
});

function flip(card, sym) {
    if (flipped.length < 2 && !card.classList.contains('done')) {
        card.innerText = sym;
        flipped.push({card, sym});

        if (flipped.length === 2) {
            if (flipped[0].sym === flipped[1].sym) {
                flipped.forEach(f => f.card.classList.add('done'));
                matched++;
                flipped = [];
                if (matched === 3) {
                    setTimeout(() => {
                        document.getElementById('memory-stage').style.display = 'none';
                        document.getElementById('maze-stage').style.display = 'block';
                    }, 600);
                }
            } else {
                setTimeout(() => {
                    flipped.forEach(f => f.card.innerText = 'â”');
                    flipped = [];
                }, 700);
            }
        }
    }
}

/* ================= MAZE GAME ================= */
let bunny = document.getElementById('bunny');
let pos = {x: 10, y: 10};

function move(dir) {
    const step = 20;
    if (dir === 'up') pos.y -= step;
    if (dir === 'down') pos.y += step;
    if (dir === 'left') pos.x -= step;
    if (dir === 'right') pos.x += step;

    bunny.style.left = pos.x + 'px';
    bunny.style.top = pos.y + 'px';

    checkWin();
}

function checkWin() {
    const goal = document.getElementById('goal').getBoundingClientRect();
    const bunnyBox = bunny.getBoundingClientRect();
    if (
        Math.abs(goal.left - bunnyBox.left) < 30 &&
        Math.abs(goal.top - bunnyBox.top) < 30
    ) {
        document.getElementById('maze-stage').style.display = 'none';
        document.getElementById('proposal-stage').style.display = 'block';
    }
}

/* ================= NO BUTTON ================= */
function moveButton() {
    const btn = document.getElementById('noBtn');
    btn.style.position = 'fixed';
    btn.style.left = Math.random() * 80 + 'vw';
    btn.style.top = Math.random() * 80 + 'vh';
}

/* ================= YES BUTTON (UNCHANGED) ================= */
function sayYes() {
    document.getElementById('proposal-stage').style.display = 'none';
    document.getElementById('success-stage').style.display = 'block';
    setInterval(createFlower, 200);
    setInterval(createHeart, 300);
}
</script>
</body>

